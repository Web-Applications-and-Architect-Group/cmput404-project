{% load static %}
{% load markdown_deux_tags %}

<!DOCTYPE html>
<html>
  <head>
    <title>{{ user.username }}</title>
  </head>

  <body>
    <style>
      ul {
        list-style-type: none;
      }
      li {
        border-style: solid;
      }
      .myStream {
        text-align: center;
      }


    </style>
    {% if posts %}
      <div class="myStream">
     <!-- <button id="show" class="home"> -->
      <a href="{% url 'profile' %}"><h4>Go Back To Profile</h4></a>
    <!-- </button> -->
      <ul style= "width: 70%; margin-left:12%;  ">

{%for post in posts%}

<script>
    var x ="ss";
    if (post.author == request.user){
        x="s";
    }
</script>


            <li>  </br>
                  {% if post.author.profile.photo %}
                      <img alt="user photo" src="{{ STATIC_URL }}/users/{{user.id}}/{{profile.photo }}" >
                  {% else %}
                      <img alt="user photo" src="{{ post.author.profile.img.url }}" width = "30" height = "30">
                  {% endif %}

                  {{ post.author }}  ({{ post.pub_datetime }})</br></br>
                  {% if post.post_type == 1 %}
                			{{ post.post_text|markdown }}</br></br>
            			{% else %}
            				{{ post.post_text|urlize }}</br></br>
                	{% endif %}

              <div style="text-align:left; margin-left:30%">
                  {% for comment in comments %}

                      {% if comment.post_id == post%}
                          comment by {{comment.author}}: {{comment.comment_text}} ({{comment.comment_date}})</br>
                      {%endif%}

                  {% endfor %}
              </div></br>

              <form action="{% url 'comment' %}" method="GET">
                    {% csrf_token %}
                      <input style= "width:50%; margin-left:10%" name="comment_text"/>
                      <input hidden="hidden" name="post_id" value = "{{post.post_id }}"/>
                      <input hidden="hidden" name="post_type" value = "{{post_type}}"/>
                      <input hidden="hidden" name="content_type" value = "{{content_type}}"/>
                      <input type="submit" value = "comment"/>
              </form></br>

              {%if post.author == request.user  %}
              <div class="editPost">
                  <form style="display: inline-block;" action="{% url 'delete_post' %}" method="GET">
                         {% csrf_token %}
                         <input hidden="hidden" name="post_type" value = "{{post_type}}"/>
                          <button  name="post_id" value="{{ post.post_id }}">Delete Post</button>
                  </form>

                  <form style="display: inline-block;" action="{% url 'manage_post' %}" method="GET">
                          <input  hidden="hidden" name="post_type" value = "{{post_type}}"/>
                          <button  name="post_id" value="{{ post.post_id }}">Modiify Post</button>
                  </form>

                  {% if post.can_view == 4 %}
                    <p>This post is publicly shareable by URI only: <a href="{{ STATIC_URL }}/post/{{ post.post_id }}">{{ STATIC_URL }}/{{ post.author }}/{{ post.post_id }}</a></p>
                  {% endif %}

              </div>
              {%endif%}
            </li></br>
    {% endfor %}</ul>
    {% else %}
      <p>You do no have any stream to show yet.</p>
    </div>
    {% endif %}
  </body>

</html>
